## 第4章 案例研究

几个 DOM 提供的新属性：`childNodes`、`nodeType`、`nodeValue`、`firstChild`、`lastChild`
	
`childNodes`：用来获取任何一个元素的所有子元素，它包含这个元素全部子元素的数组。

`nodeType`：nodeType 属性共有12种取值，但其中仅有3种具有实用价值：

- **元素节点**的 nodeType 属性值是1
- **属性节点**的 nodeType 属性值是2
- **文本节点**的 nodeType 属性值是3

`nodeValue`：获取**文本节点**的值，而非元素本身的值。

## 第5章 最佳实践

#### 性能考虑

1. 尽量少访问DOM和尽量减少标记

	- 访问DOM会搜索整个DOM树
	
	- 文档中的过多不必要的元素（标记数量）会增加DOM树的规模，进而增加遍历DOM树以查找特定元素的时间

2. 合并和放置脚本

	- 将多个脚本文件合并到一个脚本文件中，这样，可以减少加载页面时发送的请求数量。而减少请求数量通常是性能优化时首要考虑的。
	
	- 脚本在标记中的位置对页面的初次加载时间也有很大影响。将脚本放在</body>之前，可以让页面变得更快。这样，在加载脚本时，window 对象的 load 事件依然可以执行对文档进行的各种操作。

	> 一般来说，根据 HTTP 规范，浏览器每次从同一个域名中最多只能同时下载两个文件。而在下载脚本期间，浏览器不会下载其他任何文件，即使是来自不同域名的文件也不会下载，所有其他资源都要等脚本加载完毕后才能下载。

3. 压缩脚本

	- 压缩脚本，即把脚本文件中不必要的字节，如空格和注释，统统删除，从而达到“压缩”文件的目的。

## 第6章 案例改进

#### 优化

1. `if(variable)` 代替 `if (variable !== null)`

2. 有判断的情况下，用三元操作符取值

	var variable = condition ? if true : if false;

		links[i].onclick = function() {
			if (showPic(this)) {
				return false;
			} else {
				return true;
			}
		}

	改为：

		links[i].onclick = function() {
			return showPic(this) ? false : true;
		}

#### DOM Core 和 HTML-DOM

- 像 `getElementById`、`getElemntsByTagName`、`getAttribute`、`setAttribute` 这些方法都是 DOM Core 的组成部分。它们并不专属于 JavaScript，支持 DOM 的任何一种程序设计语言都可以使用它们。它们的用途也并非仅限于处理网页，它们可以用来处理任何一种标记语言（如XML）编写出来的文档。

- 使用 JavaScript 语言和 DOM 为 HTML 文件编写脚本时，有许多属性可供选择，如`onclick`、`form`、`src`、`href`等，这些属性术语 HTML-DOM。

	`document.getElementsByTagName('form')` 等价于 `document.forms`
	
	`element.getAttribute('src')` 等价于 `element.src`

## 第7章 动态创建标记

#### 传统技术

1. documnet.write()

2. innerHTML

#### DOM 方法

1. `createElement`：创建元素节点

		document.createElement(nodeName);

2. `createTextNode`：创建文本节点

		document.createTextNode(text);

3. `appendChild`

		parent.appendChild(child);

#### 重回图片库

1. `insertBefore`

		parentElement.insertBefore(newElement, targetElement);

2. 编写 `insertAfter` 函数

		function insertAfter(newElement, targetElement) {
		    var parent = targetElement.parentNode;
		    if (parent.lastChild == targetElement) {
		        parent.appendChild(newElement);
		    } else {
		        parent.insertBefore(newElement, targetElement.nextSibling);
		    }
		}
		
		var child2 = document.createElement('div');
		var child2Txt = document.createTextNode('I am child2');
		child2.appendChild(child2Txt);
		
		// 刷新 child2Txt 的文本值
		child2Txt.nodeValue = 'I am child2 new';
		
		var child3 = document.createElement('div');
		/*var child3Txt = document.createTextNode('I am child3');
		child3.appendChild(child3Txt);*/
		
		// 替代方式
		child3.innerText = 'I am child3';
		
		var child1 = document.getElementsByClassName('child1')[0];
		var parent = document.getElementsByClassName('parent')[0];
		parent.insertBefore(child2, child1);
		
		insertAfter(child3, child2);

#### Ajax

Ajax 的主要优势：对页面的请求以异步方式发送到服务器。而服务器不会用整个页面来响应请求，它会在后台处理请求，与此同时用户还能继续浏览页面并与页面交互。你的脚本则可以按需加载和创建页面内容，而不会打断用户的浏览体验。
